<section id="performance-report-selector" class="panel panel-default">
    <div class="panel-body">
        <form name="alertForm" class="form-inline" role="form" ng-submit="getAlerts()" novalidate>
            <div class="publisher form-group" ng-if="isAdmin()">
                <label>{{ 'PUBLISHER' | translate }}</label>
                <ui-select name="publisher" ng-model="selectedData.publisherId" on-select="selectPublisher()" ng-required="true" reset-search-input="'false'">
                    <ui-select-match placeholder="{{ 'PUBLISHER_MODULE.SELECT_A_PUBLISHER' | translate }}">{{ $select.selected.company }}</ui-select-match>
                    <ui-select-choices group-by="groupEntities" repeat="publisher.id as publisher in publishers | filter: $select.search">
                        <div ng-bind-html="publisher.company | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>

            <div class="publisher form-group" ng-if="selectedData.publisherId || !isAdmin()">
                <label>{{ 'DATA_SOURCE' | translate }}</label>
                <ui-select name="publisher" ng-model="selectedData.dataSource" ng-required="true" on-select="selectDataSource()" reset-search-input="'false'">
                    <ui-select-match placeholder="{{ 'UNIFIED_REPORT_DATA_SOURCE_MODULE.SELECT_A_DATA_SOURCE' | translate }}">{{ $select.selected.name + ($select.selected.id ? ' (ID: '+ $select.selected.id +')' : '') }}</ui-select-match>
                    <ui-select-choices group-by="groupEntities" repeat="dataSource.id as dataSource in dataSources | selectedPublisher:selectedData.publisherId | filter: $select.search">
                        {{ dataSource.name + (dataSource.id ? ' (ID: '+ dataSource.id +')' : '') }}
                    </ui-select-choices>
                </ui-select>
            </div>

            <div class="publisher form-group select-breakdown">
                <label>Type</label>
                <ui-select name="publisher" ng-model="selectedData.labelType" ng-required="true" reset-search-input="'false'">
                    <ui-select-match placeholder="Select a type">{{ selectedData.labelType }}</ui-select-match>
                    <ui-select-choices group-by="groupEntities" repeat="type.key as type in alertTypes">
                        <label stop-event class="ui-checkbox"><input server-error name="active" type="checkbox" ng-model="selectedData.type[type.key]" ng-click="clickType(type.key, selectedData.type[type.key])"><span> {{ type.label }}</span></label>
                    </ui-select-choices>
                </ui-select>
            </div>

            <button  ng-disabled="!isFormValid()" type="submit" class="btn btn-primary">Get Alerts</button>
        </form>
    </div>
</section>

<div class="panel panel-default">
    <div class="panel-heading">
        <span current-page-title></span>
    </div>

    <!--<search-box show-query="true" sb-list="alerts" search-fields="['id','title','message']"></search-box>-->

    <div class="panel-body">
        <div class="table-responsive mail-container">
            <div class="mail-options">
                <!--<label class="ui-checkbox"><input name="checkbox1" type="checkbox" value="option1" ng-model="checkAllItem" ng-click="selectAll()"><span>Toggle All</span></label>-->

                <div class="btn-group pull-left check-toggle-dropdown" dropdown>
                    <button type="button" class="btn" ng-disabled="alerts.length == 0" dropdown-toggle>
                        <label stop-event class="ui-checkbox check-toggle-alert"><input name="checkbox1" type="checkbox" value="option1" ng-model="checkAllItem" ng-click="selectAll()"><span></span></label>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu pull-right-dropdown" role="menu">
                        <li ng-click="selectAllAlertInPages()"><a>All Pages</a></li>
                        <li ng-click="noneSelect()"><a>None</a></li>
                    </ul>
                </div>

                <div class="btn-group pull-left" dropdown>
                    <button type="button" class="btn" ng-disabled="selectedAlert.length == 0" dropdown-toggle> {{ 'ACTIONS' | translate }} <span class="caret"></span> </button>
                    <ul class="dropdown-menu pull-right-dropdown" role="menu">
                        <li><a ng-click="markAsReadMulti()">{{ 'UNIFIED_REPORT_ALERT_MODULE.MARK_AS_READ' | translate }}</a></li>

                        <li class="divider"></li>
                        <li><a ng-click="markAsUnreadMulti()">{{ 'UNIFIED_REPORT_ALERT_MODULE.MARK_AS_UNREAD' | translate }}</a></li>

                        <li class="divider"></li>
                        <li><a ng-click="confirmClick('Are you sure want to delete this alerts?') && deleteAlertMulti()" confirm-click >{{ 'UNIFIED_REPORT_ALERT_MODULE.DELETE' | translate }}</a></li>
                    </ul>

                </div>

                <div ng-if="selectedAlert.length > 0" class="alert alert-warning alert-number">
                    All <strong>{{ selectedAlert.length }}</strong> alerts on this page are selected.
                </div>
            </div>

            <table class="table" at-action-sortable-query at-sortable-query at-table at-paginated at-list="alerts" at-config="tableConfig">
                <thead>
                <tr>
                    <th ng-show="isAdmin()" at-attribute="publisher.company">{{ 'PUBLISHER' | translate }}</th>
                </thead>
                <tbody>
                <tr ng-class="{'mail-unread': !item.isRead}" ng-init="setItemForPager(item)">
                    <td at-title="#" at-attribute="id" at-initial-sorting="desc"><label class="ui-checkbox"><input type="checkbox" ng-checked="checkedAlert(item)" ng-click="selectEntity(item)"><span></span></label></td>
                    <td at-title="{{ 'ACTIONS' | translate }}" at-attribute="action">
                        <div class="btn-group" dropdown>
                            <button type="button" class="btn " dropdown-toggle> {{ 'ACTIONS' | translate }} <span class="caret"></span> </button>
                            <ul class="dropdown-menu pull-right-dropdown" role="menu">
                                <li ng-if="!item.viewDetail"><a ng-click="viewDetail(item)">{{ 'UNIFIED_REPORT_ALERT_MODULE.VIEW_DETAIL' | translate }}</a></li>

                                <!--<li ng-if="item.isRead == false" class="divider"></li>-->
                                <li ng-if="item.isRead == false"><a ng-click="markAsRead(item)">{{ 'UNIFIED_REPORT_ALERT_MODULE.MARK_AS_READ' | translate }}</a></li>

                                <!--<li ng-if="item.isRead == false" class="divider"></li>-->
                                <li ng-if="item.isRead == true"><a ng-click="markAsUnread(item)">{{ 'UNIFIED_REPORT_ALERT_MODULE.MARK_AS_UNREAD' | translate }}</a></li>

                                <li class="divider"></li>
                                <li><a ng-click="confirmClick('Are you sure want to delete this alert?') && deleteAlert(item)" confirm-click >{{ 'UNIFIED_REPORT_ALERT_MODULE.DELETE' | translate }}</a></li>
                            </ul>
                        </div>
                    </td>
                    <td at-title="{{  'UNIFIED_REPORT_ALERT_MODULE.SUMMARY' | translate }}" at-attribute="message.message">
                        {{ getTitleAlert(item) }}
                    </td>
                    <td at-title="Type" at-sortable at-implicit at-attribute="type">
                        <span class="label" ng-class="item.type == 'info' ? 'label-info' : (item.type == 'warning' ? 'label-warning' : 'label-danger')">{{ item.type }}</span>
                    </td>
                    <td ng-show="isAdmin()" at-implicit at-attribute="publisher.company" at-title="{{ 'PUBLISHER' | translate }}"></td>
                    <td at-title="{{  'UNIFIED_REPORT_ALERT_MODULE.DATE_CREATED' | translate }}" at-sortable at-implicit at-attribute="createdDate">
                        {{ item.createdDate | date:'MMM d, y H:mm:ss' }}
                    </td>
                </tr>
                </tbody>
            </table>

           <!-- <at-pagination at-pagination-query ng-if="showPagination()" at-list="alerts" at-config="tableConfig"></at-pagination>-->

            <div style="float:left; display: flex; margin-right: 20px; margin-top: 5px">
                <pagination ng-if="showPagination()" class="pagination" boundary-links="true" previous-text="&lsaquo;" next-text="&rsaquo;" items-per-page="tableConfig.itemsPerPage" total-items="tableConfig.totalItems" ng-model="availableOptions.currentPage" max-size="tableConfig.maxPages" ng-change="changePage(availableOptions.currentPage)"> </pagination>

                <div style="margin-top: 25px;">
                    <label class="items-per-page" for="selectItemsPerPage"> Items Per Page </label>
                    <select id="selectItemsPerPage" ng-change="changeItemsPerPage()" ng-model="tableConfig.itemsPerPage">
                        <option ng-repeat="option in itemsPerPageList" value="{{option}}">{{option}}</option>
                    </select>

                </div>
            </div>


        </div>
    </div>
</div>