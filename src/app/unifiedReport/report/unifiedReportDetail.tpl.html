<div id="form-date-range-selector" class="panel panel-default" ng-if="hideDaterange()">
    <div class="panel-body">
        <form name="reportSelectorForm" class="form-inline" role="form" ng-submit="generateReport(date)" novalidate>
            <div class="form-group">
                <label for="inputDateRange">{{ 'DASHBOARD_MODULE.DATE_RANGE' | translate }}</label>
                <div>
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input date-range-picker ng-disabled="!hasFilterDate()" options="datePickerOpts" class="form-control date-picker" type="text" id="inputDateRange" ng-model="date" ng-required="true">
                    </div>
                </div>
            </div>
            <button type="submit" class="btn btn-primary" ng-disabled="!hasFilterDate()">Run Report</button>
        </form>
    </div>
</div>

<section class="panel panel-default">
    <div class="panel-heading">
        <span class="glyphicon glyphicon-th"></span> <strong current-page-title></strong>

        <div class="button-bar">
            <button style="margin-right: 3px"  class="btn btn-sm btn-primary" ng-click="refreshData()" type="button">Refresh</button>
            <export-excel ng-if="reports.length > 0 && hasResult" not-filter="true" data="reports" style="margin-right: 3px" fields="columnReportDetailForExportExcel" header="titleReportDetailForExportExcel" file-name="getExportExcelFileName()"></export-excel>
            <button ng-disabled="hasSaveRepoerView" ng-click="saveReportView()" class="btn btn-sm btn-primary" type="button">Save as Report View</button>
            <button ui-sref="^.editBuilder(reportViewForEdit)" ng-disabled="formProcessing" class="btn btn-sm btn-primary" type="button">Edit Report View</button>
        </div>

        <div class="btn-group btnGrouped" dropdown>
            <button type="button" class="btn " dropdown-toggle><span class="glyphicon glyphicon-align-justify"
                                                                     aria-hidden="true"></span></button>
            <ul class="dropdown-menu pull-right" role="menu">
                <li><a ng-click="refreshData()">Refresh</a></li>
                <li ng-if="reports.length > 0 && hasResult"><a><export-excel not-filter="true" css-class="''" data="reports" fields="columnReportDetailForExportExcel" header="titleReportDetailForExportExcel" file-name="getExportExcelFileName()"></export-excel></a></li>
                <li ng-if="hasSaveRepoerView"><a ng-click="saveReportView()">Save as Report View</a></li>
                <li><a ui-sref="^.editBuilder(reportViewForEdit)">Edit Report View</a></li>
            </ul>
        </div>
    </div>

    <div class="panel-body" ng-if="reports.length > 0 && hasResult">
        <div class="table-responsive table-report-view">
            <table class="table">
                <thead>
                <tr>
                    <th ng-class="{minWidth100: (types[column] == 'date' || types[column] == 'datetime')}" ng-repeat="column in columnPositions" ng-click="sort(column)">{{ titleColumns[column] }}
                        <span class="glyphicon glyphicon-minus" ng-show="!isShow(column)"></span>
                        <span class="glyphicon" ng-show="isShow(column)" ng-class="{'glyphicon-chevron-up':!reverse,'glyphicon-chevron-down':reverse}"></span>
                    </th>
                </tr>
                </thead>

                <tbody>
                <tr dir-paginate="report in tempReports | orderBy:sortBy:reverse | itemsPerPage:tableConfig.itemsPerPage">
                    <td ng-if="hasSort" ng-repeat="column in columnPositions">
                        <span ng-if="!isNullValue(reports[report.position], column)"> {{ reports[report.position][column] }} </span>
                    </td>
                </tr>

                <tr dir-paginate="report in reports | itemsPerPage:tableConfig.itemsPerPage">
                    <td ng-if="!hasSort" ng-repeat="column in columnPositions">
                        <span ng-if="!isNullValue(report, column)"> {{ report[column]}} </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="pagination">
            <dir-pagination-controls max-size="10" direction-links="true" boundary-links="true"></dir-pagination-controls>
            <items-per-page init="tableConfig.itemsPerPage" range="itemsPerPage" sources="reports"></items-per-page>
        </div>
    </div>
</section>

<div class="row"  ng-if="hasResult">
    <div class="col-md-6" ng-if="isEmptyObject(reportGroup.total)">
        <div class="panel panel-default">
            <div class="panel-heading"><span class="glyphicon glyphicon-th"></span> Totals</div>
            <div class="panel-body">
                <ul class="list-unstyled report-builder list-info">
                    <li ng-repeat="(key, value) in reportGroup.total">
                        <label>{{ !!titleColumns[key] ? titleColumns[key] : key }}</label>
                        <span class="pull-right">{{ value }}</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6" ng-if="isEmptyObject(reportGroup.average)">
        <div class="panel panel-default">
            <div class="panel-heading"><span class="glyphicon glyphicon-th"></span> Averages</div>
            <div class="panel-body">
                <ul class="list-unstyled report-builder list-info">
                    <li ng-repeat="(key, value) in reportGroup.average">
                        <label>{{ !!titleColumns[key] ? titleColumns[key] : key }}</label>
                        <span class="pull-right">{{ value }}</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
