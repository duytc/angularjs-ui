<div class="panel panel-default">
    <div class="panel-heading">
        <span>{{'NEW_DASHBOARD.OVERVIEW'|translate}}</span>
    </div>
    <div class="panel-body">
        <div>
            <alert class="alert alert-warning" ng-show="alertMessage.isShow">{{$scope.alertMessage.content}}</alert>
        </div>

        <!--buttons-->
        <div class="btn-group pull-left">
            <button type="button" class="btn btn-default btn-action"
                    ng-class="{active: compareTypeData.compareType === 'yesterday'}"
                    ng-click="onChangeMode('yesterday')">{{'NEW_DASHBOARD.YESTERDAY' | translate}}
            </button>
            <button type="button" class="btn btn-default btn-action"
                    ng-class="{active: compareTypeData.compareType === 'day-over-day'}"
                    ng-click="onChangeMode('day')">{{'NEW_DASHBOARD.DAY_OVER_DAY' | translate}}
            </button>
            <button type="button" class="btn btn-default btn-action"
                    ng-class="{active: compareTypeData.compareType === 'week-over-week'}"
                    ng-click="onChangeMode('week')">{{'NEW_DASHBOARD.LAST_7_DAY' | translate}}
            </button>
            <button type="button" class="btn btn-default btn-action"
                    ng-class="{active: compareTypeData.compareType === 'month-over-month'}"
                    ng-click="onChangeMode('month')">{{'NEW_DASHBOARD.LAST_30_DAY' | translate}}
            </button>
            <button type="button" class="btn btn-default btn-action"
                    ng-class="{active: compareTypeData.compareType === 'year-over-year'}"
                    ng-click="onChangeMode('year')">{{'NEW_DASHBOARD.YEAR_TO_DATE' | translate}}
            </button>
            <button type="button" class="btn btn-default btn-action"
                    ng-if="isShowForDisplayReport()"
                    ng-class="{active: compareTypeData.compareType === 'custom'}"
                    ng-click="onChangeMode('custom')">{{'NEW_DASHBOARD.CUSTOM_COMPARISON' | translate}}
            </button>

        </div>

        <div class="clearfix" style="padding: 10px 10px"></div>

        <form class="padding-10" role="form" novalidate ng-if="compareTypeData.compareType === 'custom'">
            <div class="row">
                <!--historyDateRange-->
                <div class="form-group col col-sm-2 col-xs-12 custom-date-range">
                    <label for="inputDateRangeCurrent">
                        {{ 'NEW_DASHBOARD.HISTORY_DATE_LABEL' | translate }}</label>
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input date-range-picker
                               options="datePickerOpts"
                               class="form-control date-picker"
                               type="text"
                               id="inputDateRangeLast"
                               ng-model="formData.historyDateRange"
                               ng-required="true">
                    </div>
                </div>
                <!--currentDateRange-->
                <div class="form-group col col-sm-2 col-xs-12 custom-date-range">
                    <label for="inputDateRangeCurrent">
                        {{ 'NEW_DASHBOARD.CURRENT_DATE_LABEL' | translate }}</label>
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input date-range-picker
                               options="datePickerOpts"
                               class="form-control date-picker"
                               type="text"
                               id="inputDateRangeCurrent"
                               ng-model="formData.currentDateRange"
                               ng-required="true">
                    </div>
                </div>
                <!--Get data-->
                <div class="form-group col col-sm-1 col-xs-12">
                    <label style="visibility: hidden">.</label>
                    <button type="button" class="btn btn-primary form-control"
                            ng-click="getCustomComparisonData()"
                            ng-if="compareTypeData.compareType === 'custom'"
                            ng-disabled="!isValidCustomDateRange()">{{'NEW_DASHBOARD.GET_REPORT' | translate}}
                    </button>
                </div>

            </div>
        </form>

        <!--Display-->
        <div class="table-responsive">
            <table class="table no-border" at-table at-list="formData.comparisonTableData" ng-if="formData.comparisonTableData">
                <thead>
                <th ng-show="isAdmin" at-attribute="billedAmount">{{ 'DASHBOARD_MODULE.BILLED_AMOUNT' | translate }}</th>
                </thead>

                <tbody>
                <tr>
                    <td><strong>{{item.label}}</strong></td>
                    <td ng-show="isAdmin" at-attribute="billedAmount" at-title="{{ 'DASHBOARD_MODULE.BILLED_AMOUNT' | translate }}">{{ item.billedAmount | currency}}</td>
                    <td at-attribute="estRevenue" at-title="{{ 'DASHBOARD_MODULE.REVENUE' | translate }}">{{ item.estRevenue | currency }}</td>
                    <td at-attribute="slotOpportunities" at-title="{{ 'DASHBOARD_MODULE.SLOT_OPPORTUNITIES' | translate }}">{{ item.slotOpportunities | number }}</td>
                    <td at-attribute="totalOpportunities" at-title="{{ 'DASHBOARD_MODULE.NETWORK_OPPORTUNITIES' | translate }}">{{ item.totalOpportunities | number }}</td>
                    <td at-attribute="adOpportunities" at-title="{{ 'DASHBOARD_MODULE.IMPRESSIONS_OPPORTUNITY' | translate }}">{{ item.adOpportunities | number }}</td>
                    <td at-attribute="passbacks" at-title="{{ 'DASHBOARD_MODULE.PASSBACKS' | translate }}">{{ item.passbacks | number }}</td>
                    <td at-attribute="fillRate" at-title="{{ 'DASHBOARD_MODULE.FILL_RATE' | translate }}">{{ item.fillRate | percentage }}</td>
                </tr>

                </tbody>
            </table>
        </div>

        <!--fake 2 row table-->
        <div class="table-responsive">
            <table class="table no-border" ng-if="showLoading && !isYesterdayType()">
                <thead> <tr> <td class="non-visible">Loading...</td> </tr> </thead> <tbody>
                <tr> <td class="text-center">
                    <img src="../../../assets/images/ajax-loader.gif"
                         height="25" width="25"/>
                </td> </tr> <tr> <td>
                    <strong class="non-visible">Loading...</strong>
                </td> </tr> </tbody>
            </table>
        </div>
        <!--fake 1 row table-->
        <div class="table-responsive">
            <table class="table no-border" ng-if="showLoading && isYesterdayType()">
                <thead> <tr> <td class="non-visible">Loading...</td> </tr> </thead>
                <tbody> <tr>  <td class="text-center">
                    <!--<strong>Loading...</strong>-->
                    <img src="../../../assets/images/ajax-loader.gif"
                         height="25" width="25"/>
                </td> </tr> </tbody>
            </table>
        </div>


        <!--TODO Please follow Display dashboard for video and UR-->

        <!--Video Yesterday-->
        <table class="table no-border table-responsive" ng-if="hasVideoOverviewTable() && compareTypeData.compareType === 'yesterday'">
            <th ng-if="isAdmin" class="text-capitalize">{{ columnNameMappingForVideoReport['billedAmount'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['netRevenue'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['requests'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['impressions'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['bids'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['errors'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['blocks'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['requestFillRate'] }}</th>

            <tr >
                <td ng-if="isAdmin">{{(customOverviewData.billedAmount != null) ? (customOverviewData.billedAmount | currency) : '' }}</td>
                <td>{{ (customOverviewData.netRevenue != null) ? (customOverviewData.netRevenue | currency) : '' }}</td>
                <td>{{ (customOverviewData.requests != null) ? (customOverviewData.requests |number) : '' }}</td>
                <td>{{ (customOverviewData.impressions != null) ? (customOverviewData.impressions | number) : '' }}</td>
                <td>{{ (customOverviewData.bids != null) ? (customOverviewData.bids | number) : '' }}</td>
                <td>{{ (customOverviewData.errors != null) ? (customOverviewData.errors | number) : '' }}</td>
                <td>{{ (customOverviewData.blocks != null) ? (customOverviewData.blocks | number) : '' }}</td>
                <td>{{ (customOverviewData.requestFillRate != null) ? (customOverviewData.requestFillRate | percentage) : '' }}</td>
            </tr>
        </table>

        <!--Video Comparison-->
        <table class="table no-border table-responsive" ng-if="compareTypeData.compareType !== 'yesterday' && hasVideoComparisonTable()">
            <th></th>
            <th ng-if="isAdmin" class="text-capitalize">{{ columnNameMappingForVideoReport['billedAmount'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['netRevenue'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['requests'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['impressions'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['bids'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['errors'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['blocks'] }}</th>
            <th class="text-capitalize">{{ columnNameMappingForVideoReport['requestFillRate'] }}</th>

            <!--current-->
            <tr >
                <td ng-if="compareTypeData.compareType == 'day-over-day'"><strong>{{getRecentDay()}}</strong></td>
                <td ng-if="compareTypeData.compareType == 'custom'"><strong>{{dateRangeString(formData.currentDateRange)}}</strong></td>
                <td ng-if="compareTypeData.compareType != 'day-over-day' && compareTypeData.compareType != 'custom'"class=""><strong>Current {{compareTypeData.label}}</strong></td>
                <td>{{ (formData.comparisionData.current.billedAmount != null) ? (formData.comparisionData.current.billedAmount | currency) : '' }} </td>
                <td>{{ (formData.comparisionData.current.netRevenue != null) ? (formData.comparisionData.current.netRevenue | number) : '' }} </td>
                <td>{{ (formData.comparisionData.current.requests != null) ? (formData.comparisionData.current.requests | number) : '' }} </td>
                <td>{{ (formData.comparisionData.current.impressions != null) ? (formData.comparisionData.current.impressions | number) : '' }} </td>
                <td>{{ (formData.comparisionData.current.bids != null) ? (formData.comparisionData.current.bids | number) : '' }} </td>
                <td>{{ (formData.comparisionData.current.errors != null) ? (formData.comparisionData.current.errors | number) : '' }} </td>
                <td>{{ (formData.comparisionData.current.blocks != null) ? (formData.comparisionData.current.blocks | number) : '' }} </td>
                <td>{{ (formData.comparisionData.current.requestFillRate != null) ? (formData.comparisionData.current.requestFillRate | percentage) : '' }} </td>
            </tr>
            <!--history-->
            <tr>
                <td ng-if="compareTypeData.compareType == 'day-over-day'"><strong>{{getPreviousDay()}}</strong></td>
                <td ng-if="compareTypeData.compareType == 'custom'"><strong>{{dateRangeString(formData.historyDateRange)}}</strong></td>
                <td ng-if="compareTypeData.compareType != 'day-over-day' && compareTypeData.compareType != 'custom'"class=""><strong>Last {{compareTypeData.label}}</strong></td>
                <td ng-if="isAdmin">{{ (formData.comparisionData.history.billedAmount != null) ? (formData.comparisionData.history.billedAmount | currency) : '' }}</td>
                <td>{{ (formData.comparisionData.history.netRevenue != null) ? (formData.comparisionData.history.netRevenue | number) : '' }}</td>
                <td>{{ (formData.comparisionData.history.requests != null) ? (formData.comparisionData.history.requests | number) : '' }}</td>
                <td>{{ (formData.comparisionData.history.impressions != null) ? (formData.comparisionData.history.impressions | number) : '' }}</td>
                <td>{{ (formData.comparisionData.history.bids != null) ? (formData.comparisionData.history.bids | number) : '' }} </td>
                <td>{{ (formData.comparisionData.history.errors != null) ? (formData.comparisionData.history.errors | number) : '' }}</td>
                <td>{{ (formData.comparisionData.history.blocks != null) ? (formData.comparisionData.history.blocks | number) : '' }}</td>
                <td>{{ (formData.comparisionData.history.requestFillRate != null) ? (formData.comparisionData.history.requestFillRate | percentage) : '' }}</td>
            </tr>
        </table>


        <!--Unified report yesterday-->
        <table class="table no-border"
               ng-if="isShowForUnifiedReport()
                &&  overviewData.data
                && overviewData.data.length > 0
                &&  compareTypeData.compareType === 'yesterday'">
            <th ng-repeat="row in customOverviewData"><span class="text-capitalize">{{row.label}}</span></th>
            <tr><td ng-repeat="row in customOverviewData">{{row.value}}</td></tr>
        </table>

        <!--Unified report comparison-->
        <table class="table no-border"
               ng-if="isShowForUnifiedReport() &&
                formData.comparisionData &&
                formData.comparisionData.length > 0 &&
                 compareTypeData.compareType !== 'yesterday'">
            <th></th>
            <th ng-repeat="row in formData.comparisionData"><span class="text-capitalize">{{row.label}}</span></th>

            <tr>
                <td ng-if="compareTypeData.compareType == 'day-over-day'"><strong>{{getRecentDay() }}</strong></td>
                <td ng-if="compareTypeData.compareType != 'day-over-day'"><strong>Current{{compareTypeData.label}}</strong></td>
                <td ng-repeat="row in formData.comparisionData">{{row.current.value}}</td>
            </tr>
            <tr>
                <td ng-if="compareTypeData.compareType == 'day-over-day'"><strong>{{getPreviousDay() }}</strong></td>
                <td ng-if="compareTypeData.compareType != 'day-over-day'"><strong>History{{compareTypeData.label}}</strong></td>
                <td ng-repeat="row in formData.comparisionData">{{row.history.value}}</td>
            </tr>
        </table>


        <!--Help text-->
        <div class="pt-10" ng-if="compareTypeData.compareType === 'custom'">
            <span>{{'NEW_DASHBOARD.TIPS' | translate}}:</span>
            <button class="btn btn-sm btn-link badge" ng-click="helpTextVisibilityStatus = !helpTextVisibilityStatus">
                <span ng-if="helpTextVisibilityStatus == true">Hide</span>
                <span ng-if="helpTextVisibilityStatus == false">Show</span>
            </button>
            <div ng-hide="!helpTextVisibilityStatus" class="callout callout-info custom-callout">
                <p class="help-text-font">{{'NEW_DASHBOARD.CUSTOM_DATE_RANGE_HELP_TEXT' | translate}}</p>
                <p class="help-text-font">{{'NEW_DASHBOARD.CUSTOM_DATE_RANGE_HELP_TEXT_VALID' | translate}}</p>
                <p class="help-text-font">{{'NEW_DASHBOARD.CUSTOM_DATE_RANGE_HELP_TEXT_INVALID' | translate}}</p>
            </div>
        </div>
     </div>
</div>

